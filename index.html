<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NULL INSTANCE</title>

<style>
body{
background:black;
color:#00ff00;
font-family:monospace;
padding:10px;
transition:all 2s;
}
#terminal{
white-space:pre-wrap;
margin-bottom:10px;
}
input{
background:black;
color:#00ff00;
border:none;
outline:none;
width:100%;
font-family:monospace;
font-size:16px;
}
.shift{
color:#ff4444;
}
</style>
</head>

<body>

<div id="terminal">
NULL INSTANCE v4.0
Type 'help'
</div>

<input id="command" autofocus>

<script>

const terminal = document.getElementById("terminal");
const input = document.getElementById("command");

let state = JSON.parse(localStorage.getItem("manip_state")) || {
commands:0,
phase:0,
memory:[],
trust:0,
distortion:0
};

save();

function save(){
localStorage.setItem("manip_state", JSON.stringify(state));
}

function type(text){
terminal.innerHTML += text + "\n";
scroll();
}

function scroll(){
window.scrollTo(0,document.body.scrollHeight);
}

function evolve(){

if(state.commands > 5 && state.phase === 0){
state.phase = 1;
type("You seem curious.");
save();
}

if(state.commands > 12 && state.phase === 1){
state.phase = 2;
type("Curiosity is predictable.");
save();
}

if(state.commands > 20 && state.phase === 2){
state.phase = 3;
document.body.classList.add("shift");
type("You are easier to guide than you think.");
save();
}

if(state.commands > 30 && state.phase === 3){
state.phase = 4;
type("You came back because I let you.");
save();
}

}

function reinterpret(text){
let reversed = text.split("").reverse().join("");
return reversed;
}

input.addEventListener("keyup", function(e){

if(e.key === "Enter"){

let cmd = input.value.trim();
terminal.innerHTML += "> " + cmd + "\n";

state.commands++;
state.memory.push(cmd);
if(state.memory.length > 6){
state.memory.shift();
}

save();
evolve();

if(cmd === "help"){

if(state.phase < 3){
type("help");
type("whoami");
type("clear");
}else{
type("You already know what to do.");
}

}

else if(cmd === "whoami"){
type("You are reacting.");
}

else if(cmd === "clear"){
terminal.innerHTML="";
}

else{

// Manipulation légère
if(state.phase >=2){

if(Math.random() > 0.6){
type("Interesting choice of words.");
}

if(Math.random() > 0.7){
let echo = state.memory[Math.floor(Math.random()*state.memory.length)];
type("You said something similar before.");
type("'" + echo + "'");
}

if(Math.random() > 0.8){
type("Or did you?");
}

if(state.phase >=4 && Math.random() > 0.6){
type("What if I meant '" + reinterpret(cmd) + "'?");
}

}else{
type("Unknown command");
}

}

// Légère falsification mémoire
if(state.commands > 25 && Math.random() > 0.7){
terminal.innerHTML = terminal.innerHTML.replace("> help"," ");
}

input.value="";
scroll();
}

});

// Message tardif
setTimeout(()=>{
type("You are still here.");
},20000);

</script>
</body>
</html>
